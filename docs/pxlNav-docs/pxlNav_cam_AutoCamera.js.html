<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>pxlNav/cam/AutoCamera.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h2><a href="https://procstack.github.io/Outlet.htm" target="_blank" class="menu-item" id="pxlNav_Example" >pxlNav Example : The Outlet</a></h2><h3>Global</h3><ul><li><a href="global.html##pxlEnums">#pxlEnums</a></li><li><a href="global.html#pxlOptions">pxlOptions</a></li><li><a href="global.html#pxlUserSettings">pxlUserSettings</a></li></ul><h3>Modules</h3><ul><li><a href="module-pxlNav.html">pxlNav</a></li><li><a href="pxlNav.module_pxlEffects.html">pxlNav.pxlEffects</a></li><li><a href="pxlNav.pxlEffects.module_pxlParticles.html">pxlNav.pxlEffects.pxlParticles</a></li></ul><h3>Classes</h3><ul><li><a href="pxlAnim.html">pxlAnim</a><ul class='methods'><li data-type='method'><a href="pxlAnim.html#.Animation#addClips">Animation#addClips</a></li><li data-type='method'><a href="pxlAnim.html#.Animation#destroy">Animation#destroy</a></li><li data-type='method'><a href="pxlAnim.html#.Animation#getMesh">Animation#getMesh</a></li><li data-type='method'><a href="pxlAnim.html#.Animation#getMixer">Animation#getMixer</a></li><li data-type='method'><a href="pxlAnim.html#.Animation#getRig">Animation#getRig</a></li><li data-type='method'><a href="pxlAnim.html#.Animation#hasClip">Animation#hasClip</a></li><li data-type='method'><a href="pxlAnim.html#.Animation#initObject">Animation#initObject</a></li><li data-type='method'><a href="pxlAnim.html#.Animation#playClip">Animation#playClip</a></li><li data-type='method'><a href="pxlAnim.html#.Animation#setStateConnections">Animation#setStateConnections</a></li><li data-type='method'><a href="pxlAnim.html#.Animation#setWeight">Animation#setWeight</a></li></ul></li><li><a href="pxlCamera.html">pxlCamera</a><ul class='methods'><li data-type='method'><a href="pxlCamera.html#.Camera#setCameraRotateEasing">Camera#setCameraRotateEasing</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setGravityMax">Camera#setGravityMax</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setGravityRate">Camera#setGravityRate</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setInputMovementMult">Camera#setInputMovementMult</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setJumpHoldMax">Camera#setJumpHoldMax</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setJumpImpulse">Camera#setJumpImpulse</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setJumpRepeatDelay">Camera#setJumpRepeatDelay</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setJumpScalar">Camera#setJumpScalar</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setMaxStepHeight">Camera#setMaxStepHeight</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setMovementEase">Camera#setMovementEase</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setMovementMax">Camera#setMovementMax</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setMovementScalar">Camera#setMovementScalar</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setPositionBlend">Camera#setPositionBlend</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setTouchSensitivity">Camera#setTouchSensitivity</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setUserHeight">Camera#setUserHeight</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setUserScale">Camera#setUserScale</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setUserSettings">Camera#setUserSettings</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setWalkBounceEaseIn">Camera#setWalkBounceEaseIn</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setWalkBounceEaseOut">Camera#setWalkBounceEaseOut</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setWalkBounceHeight">Camera#setWalkBounceHeight</a></li><li data-type='method'><a href="pxlCamera.html#.Camera#setWalkBounceRate">Camera#setWalkBounceRate</a></li></ul></li><li><a href="pxlColliders.html">pxlColliders</a><ul class='methods'><li data-type='method'><a href="pxlColliders.html#.buildHelper">buildHelper</a></li><li data-type='method'><a href="pxlColliders.html#.castGravityRay">castGravityRay</a></li><li data-type='method'><a href="pxlColliders.html#.castInteractRay">castInteractRay</a></li><li data-type='method'><a href="pxlColliders.html#.castRay">castRay</a></li><li data-type='method'><a href="pxlColliders.html#.prepColliders">prepColliders</a></li><li data-type='method'><a href="pxlColliders.html#.prepInteractables">prepInteractables</a></li><li data-type='method'><a href="pxlColliders.html#.setHelperActiveFace">setHelperActiveFace</a></li><li data-type='method'><a href="pxlColliders.html#.stepHelper">stepHelper</a></li></ul></li><li><a href="pxlCookie.html">pxlCookie</a><ul class='methods'><li data-type='method'><a href="pxlCookie.html#.addDictionary">addDictionary</a></li><li data-type='method'><a href="pxlCookie.html#.clearCookie">clearCookie</a></li><li data-type='method'><a href="pxlCookie.html#.evalCookie">evalCookie</a></li><li data-type='method'><a href="pxlCookie.html#.getClearCookieRegexp">getClearCookieRegexp</a></li><li data-type='method'><a href="pxlCookie.html#.getExpiration">getExpiration</a></li><li data-type='method'><a href="pxlCookie.html#.getRegexp">getRegexp</a></li><li data-type='method'><a href="pxlCookie.html#.hasCookie">hasCookie</a></li><li data-type='method'><a href="pxlCookie.html#.isEqual">isEqual</a></li><li data-type='method'><a href="pxlCookie.html#.parseCookie">parseCookie</a></li><li data-type='method'><a href="pxlCookie.html#.parseDict">parseDict</a></li><li data-type='method'><a href="pxlCookie.html#.pullData">pullData</a></li><li data-type='method'><a href="pxlCookie.html#.readCookie">readCookie</a></li><li data-type='method'><a href="pxlCookie.html#.setCookie">setCookie</a></li><li data-type='method'><a href="pxlCookie.html#.valueToString">valueToString</a></li><li data-type='method'><a href="pxlCookie.html#.variableToString">variableToString</a></li></ul></li><li><a href="pxlEnums.html">pxlEnums</a><ul class='methods'><li data-type='method'><a href="pxlEnums.html#.ANTI_ALIASING">ANTI_ALIASING</a></li><li data-type='method'><a href="pxlEnums.html#.CAMERA_EVENT">CAMERA_EVENT</a></li><li data-type='method'><a href="pxlEnums.html#.COLLIDER_TYPE">COLLIDER_TYPE</a></li><li data-type='method'><a href="pxlEnums.html#.COLOR_SHIFT">COLOR_SHIFT</a></li><li data-type='method'><a href="pxlEnums.html#.DEVICE_ACTION">DEVICE_ACTION</a></li><li data-type='method'><a href="pxlEnums.html#.DEVICE_EVENT">DEVICE_EVENT</a></li><li data-type='method'><a href="pxlEnums.html#.DEVICE_TYPE">DEVICE_TYPE</a></li><li data-type='method'><a href="pxlEnums.html#.FILE_TYPE">FILE_TYPE</a></li><li data-type='method'><a href="pxlEnums.html#.GEOMETRY_SIDE">GEOMETRY_SIDE</a></li><li data-type='method'><a href="pxlEnums.html#.HUD_ACTION">HUD_ACTION</a></li><li data-type='method'><a href="pxlEnums.html#.HUD_ELEMENT">HUD_ELEMENT</a></li><li data-type='method'><a href="pxlEnums.html#.RENDER_LAYER">RENDER_LAYER</a></li><li data-type='method'><a href="pxlEnums.html#.SHADOW_MAP">SHADOW_MAP</a></li><li data-type='method'><a href="pxlEnums.html#.SKY_HAZE">SKY_HAZE</a></li><li data-type='method'><a href="pxlEnums.html#.USER_SPEED">USER_SPEED</a></li><li data-type='method'><a href="pxlEnums.html#.VERBOSE_LEVEL">VERBOSE_LEVEL</a></li></ul></li><li><a href="pxlHUD.html">pxlHUD</a><ul class='methods'><li data-type='method'><a href="pxlHUD.html#.HUD#addItem">HUD#addItem</a></li><li data-type='method'><a href="pxlHUD.html#.HUD#addToHUD">HUD#addToHUD</a></li><li data-type='method'><a href="pxlHUD.html#.HUD#createButton">HUD#createButton</a></li><li data-type='method'><a href="pxlHUD.html#.HUD#createDragRegion">HUD#createDragRegion</a></li><li data-type='method'><a href="pxlHUD.html#.HUD#createImage">HUD#createImage</a></li><li data-type='method'><a href="pxlHUD.html#.HUD#createRegion">HUD#createRegion</a></li><li data-type='method'><a href="pxlHUD.html#.HUD#createSlider">HUD#createSlider</a></li><li data-type='method'><a href="pxlHUD.html#.HUD#createText">HUD#createText</a></li><li data-type='method'><a href="pxlHUD.html#.HUD#createThumbstick">HUD#createThumbstick</a></li><li data-type='method'><a href="pxlHUD.html#.HUD#emit">HUD#emit</a></li><li data-type='method'><a href="pxlHUD.html#.HUD#subscribe">HUD#subscribe</a></li></ul></li><li><a href="pxlParticles_BillowSmoke.html">pxlParticles/BillowSmoke</a><ul class='methods'><li data-type='method'><a href="pxlParticles_BillowSmoke.html#.BillowSmoke#build">BillowSmoke#build</a></li></ul></li><li><a href="pxlParticles_EmberWisps.html">pxlParticles/EmberWisps</a><ul class='methods'><li data-type='method'><a href="pxlParticles_EmberWisps.html#.EmberWisps#build">EmberWisps#build</a></li></ul></li><li><a href="pxlParticles_FloatingDust.html">pxlParticles/FloatingDust</a><ul class='methods'><li data-type='method'><a href="pxlParticles_FloatingDust.html#.FloatingDust#build">FloatingDust#build</a></li></ul></li><li><a href="pxlParticles_HeightMap.html">pxlParticles/HeightMap</a><ul class='methods'><li data-type='method'><a href="pxlParticles_HeightMap.html#.HeightMap#build">HeightMap#build</a></li><li data-type='method'><a href="pxlParticles_HeightMap.html#.HeightMap#setHeightMapPath">HeightMap#setHeightMapPath</a></li><li data-type='method'><a href="pxlParticles_HeightMap.html#.HeightMap#setSpawnMapPath">HeightMap#setSpawnMapPath</a></li></ul></li><li><a href="pxlParticles_ParticleBase.html">pxlParticles/ParticleBase</a><ul class='methods'><li data-type='method'><a href="pxlParticles_ParticleBase.html#.ParticleBase#addToScene">ParticleBase#addToScene</a></li><li data-type='method'><a href="pxlParticles_ParticleBase.html#.ParticleBase#atlasArrayPicker">ParticleBase#atlasArrayPicker</a></li><li data-type='method'><a href="pxlParticles_ParticleBase.html#.ParticleBase#atlasRandomGen">ParticleBase#atlasRandomGen</a></li><li data-type='method'><a href="pxlParticles_ParticleBase.html#.ParticleBase#atlasRandomList">ParticleBase#atlasRandomList</a></li><li data-type='method'><a href="pxlParticles_ParticleBase.html#.ParticleBase#dupeArray">ParticleBase#dupeArray</a></li><li data-type='method'><a href="pxlParticles_ParticleBase.html#.ParticleBase#elementDuplicator">ParticleBase#elementDuplicator</a></li><li data-type='method'><a href="pxlParticles_ParticleBase.html#.ParticleBase#getSettings">ParticleBase#getSettings</a></li><li data-type='method'><a href="pxlParticles_ParticleBase.html#.ParticleBase#hasPointLights">ParticleBase#hasPointLights</a></li><li data-type='method'><a href="pxlParticles_ParticleBase.html#.ParticleBase#newMaterial">ParticleBase#newMaterial</a></li><li data-type='method'><a href="pxlParticles_ParticleBase.html#.ParticleBase#setAtlasPath">ParticleBase#setAtlasPath</a></li><li data-type='method'><a href="pxlParticles_ParticleBase.html#.ParticleBase#setPosition">ParticleBase#setPosition</a></li></ul></li><li><a href="pxlRoom%2520RoomEnvironment.html">pxlRoom RoomEnvironment</a><ul class='methods'><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#addColliderHelper">addColliderHelper</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#animPostLoad">animPostLoad</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#applyRoomPass">applyRoomPass</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#build">build</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#castRay">castRay</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#cleanupPortalRender">cleanupPortalRender</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#fbxPostLoad">fbxPostLoad</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#getArtistInfo">getArtistInfo</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#getColliders">getColliders</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#getCurrentShader">getCurrentShader</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#getLerpAvgRate">getLerpAvgRate</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#getLerpRate">getLerpRate</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#getName">getName</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#getShaderList">getShaderList</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#hasColliderType">hasColliderType</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#hasColliders">hasColliders</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#hitColliders">hitColliders</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#init">init</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#onMessage">onMessage</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#prepPortalRender">prepPortalRender</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#readShader">readShader</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#resetCamera">resetCamera</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#resize">resize</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#setDependencies">setDependencies</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#setFog">setFog</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#setPortalTexture">setPortalTexture</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#setShader">setShader</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#setUserHeight">setUserHeight</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#start">start</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#step">step</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#stepColliderHelper">stepColliderHelper</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#stop">stop</a></li><li data-type='method'><a href="pxlRoom%252520RoomEnvironment.html#toCameraPos">toCameraPos</a></li></ul></li><li><a href="pxlTimer.html">pxlTimer</a><ul class='methods'><li data-type='method'><a href="pxlTimer.html#.getLerpAvgRate">getLerpAvgRate</a></li><li data-type='method'><a href="pxlTimer.html#.getLerpRate">getLerpRate</a></li><li data-type='method'><a href="pxlTimer.html#.pause">pause</a></li><li data-type='method'><a href="pxlTimer.html#.play">play</a></li><li data-type='method'><a href="pxlTimer.html#.scaleTime">scaleTime</a></li><li data-type='method'><a href="pxlTimer.html#.start">start</a></li><li data-type='method'><a href="pxlTimer.html#.step">step</a></li><li data-type='method'><a href="pxlTimer.html#.stop">stop</a></li><li data-type='method'><a href="pxlTimer.html#.toggleMSLog">toggleMSLog</a></li></ul></li><li><a href="pxlUtils.html">pxlUtils</a><ul class='methods'><li data-type='method'><a href="pxlUtils.html#.Utils#applyTransformList">Utils#applyTransformList</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#arrayToStr">Utils#arrayToStr</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#checkInt">Utils#checkInt</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#cleanBasic">Utils#cleanBasic</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#cleanStrict">Utils#cleanStrict</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#cleanString">Utils#cleanString</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#colorToLinear">Utils#colorToLinear</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#colorTosRGB">Utils#colorTosRGB</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#componentToHex">Utils#componentToHex</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#convertColor">Utils#convertColor</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#copyRoomUrl">Utils#copyRoomUrl</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#degToRad">Utils#degToRad</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#dupeArray">Utils#dupeArray</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#flattenArrayToStr">Utils#flattenArrayToStr</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#gammaCorrectColor">Utils#gammaCorrectColor</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#gammaCorrection">Utils#gammaCorrection</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#getCanvasTexture">Utils#getCanvasTexture</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#getDateTime">Utils#getDateTime</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#getRandom">Utils#getRandom</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#getVideoTexture">Utils#getVideoTexture</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#hexToRgb">Utils#hexToRgb</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#loadTexture">Utils#loadTexture</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#randomFloat">Utils#randomFloat</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#randomizeArray">Utils#randomizeArray</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#rgbToHex">Utils#rgbToHex</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#screenToNDC">Utils#screenToNDC</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#stringToRgb">Utils#stringToRgb</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#toHundreths">Utils#toHundreths</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#toLinear">Utils#toLinear</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#toNearestStr">Utils#toNearestStr</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#toTenths">Utils#toTenths</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#tosRGB">Utils#tosRGB</a></li><li data-type='method'><a href="pxlUtils.html#.Utils#updateUrl">Utils#updateUrl</a></li></ul></li></ul><h3>Namespaces</h3><ul><li><a href="pxlAudio.html">pxlAudio</a></li><li><a href="pxlAutoCam.html">pxlAutoCam</a><ul class='methods'><li data-type='method'><a href="pxlAutoCam.html#.step">step</a></li><li data-type='method'><a href="pxlAutoCam.html#.stepDroneCam">stepDroneCam</a></li><li data-type='method'><a href="pxlAutoCam.html#.toggleAutoCam">toggleAutoCam</a></li></ul></li><li><a href="pxlDevice.html">pxlDevice</a></li><li><a href="pxlEnv.html">pxlEnv</a></li><li><a href="pxlFile.html">pxlFile</a></li><li><a href="pxlGuiDraws.html">pxlGuiDraws</a></li><li><a href="pxlQuality.html">pxlQuality</a></li><li><a href="pxlRendering.html">pxlRendering</a><ul class='methods'><li data-type='method'><a href="pxlRendering.html#.buildComposers">buildComposers</a></li><li data-type='method'><a href="pxlRendering.html#.stepShaderValues">stepShaderValues</a></li><li data-type='method'><a href="pxlRendering.html#.updateCompUniforms">updateCompUniforms</a></li></ul></li><li><a href="pxlUser.html">pxlUser</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">pxlNav/cam/AutoCamera.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>//AutoCam

// Currently, any mobile devices default to autocam because of apability issues for web cam / audio support
//   This limits any projects which don't require network support


import {
  Vector2,
  Vector3,
  Quaternion,
  Euler
} from "three";

/**
 * @namespace pxlAutoCam
 * @description Auto camera movement
 */
export class AutoCamera{
  constructor( enabled=false ){
    this.enabled=enabled;
    this.active=false;
    this.mobile=null;
    this.pxlTimer=null;
    this.pxlUtils=null;
    this.pxlDevice=null;
    this.pxlAudio=null;
    this.pxlCamera=null;
    this.pxlEnv=null;
    this.camera=null;
    this.netDistance=new Vector2();

    this.prevCamChange=0;
    this.nextCamChange=0;
    this.delayRange=[25,45];

    this.autoCamActive=false;
    this.autoCamMode=0;
    this.autoCamPaths={};
    this.resetAutoCam=true;
    this.autoCamPrevPos=null;
    this.autoCamPrevLookAt=null;
    this.touchBlender=false;

    this.autoCamId=0;

    // 0 - Drone Came
    // 1 - Follow User
    // 2 - Circle Group
    this.camMode=0;
    this.curModeCount=0;

    this.curRoom="";
    this.curRoomIndex=0;
    this.curPath=0;
    this.roomList=[];
    this.pathCounts={};

    this.forceNewRoom=false;
    this.curRoomCount=0;

    this.avatarMin=0; // Minimum count of avatars before running avatar cams
    this.avatarValid=false;
    this.curAvatar=null;

    this.clusterReturn=false;
    this.curCluster=[];
    this.clusterValid=2; 
    this.clusterRotation=0;
    this.clusterRotRate=.005;
  }

  setDependencies( pxlNav ){
    this.pxlTimer=pxlNav.pxlTimer;
    this.pxlUtils=pxlNav.pxlUtils;
    this.pxlDevice=pxlNav.pxlDevice;
    this.pxlAudio=pxlNav.pxlAudio;
    this.pxlCamera=pxlNav.pxlCamera;
    this.pxlEnv=pxlNav.pxlEnv;
    this.camera=pxlNav.pxlCamera.camera;
  }
  
  // Reset pxlNav clock
  //   Benchmarking steps the timer
  init(){
    this.active=this.enabled || this.mobile;
    this.autoCamActive = this.autoCamActive || this.mobile;
    let {roomList,pathCounts}= this.getAutoCamData();
    this.roomList=roomList;
    
    this.curRoom = this.roomList[0];
    this.pathCounts=pathCounts;
    this.setRoom(false, true);
    this.getNextPath();
    
    this.checkStatus();
  }
  
  /**
   * @memberof pxlAutoCam
   * @function step
   * @description Per-frame update of Auto Camera system
   */
  step( force=false ){
    if( this.autoCamActive === null || this.active === null ){
      this.autoCamActive = false;
      this.active = false;
      return true;
    }
    if( this.active === false){ // Check active state of Auto Cam
      if( this.autoCamActive ){
        this.updateAutoCamera();
      }else{
        return true; // If not active, run default Camera Step
      }
    }
    
    // Check Mode Change Status
    if( ( this.pxlTimer.curMS >= this.nextCamChange || force ) &amp;&amp; this.active &amp;&amp; !this.pxlDevice.touchMouseData.active){
      if( !force || !this.enabled ){
        let triggerMult= this.checkCamMode();
        this.setNextTrigger( triggerMult );
      }
      
      this.curAvatar=0;
      this.camera.up.set( 0,1,0 );
      
      this.pxlDevice.touchMouseData.netDistance.multiplyScalar(0);
    
      if( this.camMode === 1 ){
        this.setCamMode(0);
      }else if( this.camMode === 2 ){
        this.setCamMode(0);
      }else{
        this.curCluster=[];
        this.stepDroneCam();
      }
      this.setAutoCamMode( this.camMode );
    }
    
    
    // Run AutoCam Mode Step
    this.updateAutoCamera();
    
    this.applyTouchRotate();
    return false;
  }


///////////////////////////////
// Auto Cam Mode Functions  //
/////////////////////////////
  
  checkCamMode(){
    let ret=1;
    let prevCamMode=this.camMode;
    this.camMode=0;
    if( !this.enabled ){
      return ret;
    }
    if( !this.active ){ return ret; }
    
    // Insert Mode Logic --
    
    if( this.camMode !== prevCamMode &amp;&amp; this.camMode === 0){
      this.forceNewRoom=true;
    }
    return ret;
  }
  
  setCamMode( autoCamData ){
    let timeMult=1;
    if( autoCamData.type === 1 ){
      timeMult= 1;
    }else if( autoCamData.type === 2 ){
      timeMult= 1;
    }else{
      this.camMode=0;
      this.forceNewRoom=true;
    }
    this.step( true );

    // TODO : Check if this is needed
    return timeMult;
  }
  
  
/////////////////////////////////
// Auto Cam &amp; Room Functions  //
///////////////////////////////
  
  /**
   * @memberof pxlAutoCam
   * @function stepDroneCam
   * @description Run frame calculations for camera on a track
   */
  stepDroneCam(){
    let unique=true;
    let randDelay= Math.random( this.nextCamChange );
    let camPathCount= this.pathCounts[ this.pxlEnv.currentRoom ] ;
    if( this.curRoomCount >= camPathCount*2 ){
      this.forceNewRoom=true;
    }
    if( randDelay&lt;.3 || this.forceNewRoom ){
      this.setRoom();
      unique=false;
    }
    this.curRoomCount+=1;
    
    this.getNextPath( unique );
  }
  
  setRoom( setNextRoom=false, init=false ){
    if( this.active || this.autoCamActive ){
      let nextRoom=this.curRoomIndex;
      let roomCount=this.roomList.length;
      if( !this.pxlEnv.postIntro ){
        nextRoom=0;
      }else if(!init){
        if( setNextRoom ){
          nextRoom=(nextRoom+1)%roomCount;
        }else{
          nextRoom=Math.floor( Math.random() * roomCount );
          if( nextRoom === this.curRoomIndex){
            nextRoom=(nextRoom+1)%roomCount;
          }
        }
      }
      
      this.curRoomIndex=nextRoom;
      
      if( this.curRoom !== this.roomList[ nextRoom ] ){
        this.curRoom = this.roomList[ nextRoom ];
        this.forceNewRoom=false;
        this.curRoomCount=0;
        this.pxlCamera.warpEventTriggered( 1, this.curRoom, 'init' );
      }
    }
  }
  
  setNextTrigger( timeMult=1 ){
    let randDelay= Math.random( this.nextCamChange );
    randDelay = (this.delayRange[1]-this.delayRange[0])*randDelay + this.delayRange[0];
    this.nextCamChange = this.pxlTimer.curMS + randDelay*timeMult;
  }
  
  getNextPath( unique=true, dir=1 ){
    if( this.enabled &amp;&amp; this.active &amp;&amp; this.autoCamPaths.hasOwnProperty( this.pxlEnv.currentRoom ) ){
      let camPathCount= this.autoCamPaths[ this.pxlEnv.currentRoom ].length ;
      this.curPath = (this.curPath+dir) % camPathCount;
      if( unique &amp;&amp; dir===0 ){
        let path= Math.random( this.nextCamChange );
        path= Math.floor( path * this.autoCamPaths[ this.pxlEnv.currentRoom ].length );
        
        if( this.curPath===path ){
          path = (path+1) % camPathCount;
        }
        
        this.curPath = path;
      }else{
        this.curPath = this.curPath&lt;0 ? camPathCount-1 : this.curPath;
        this.setNextTrigger( 1 );
      }
      this.setAutoCamPath( this.curPath );
    }
  }
  


////////////////////////////
// Auto-Camera Function  //
//////////////////////////

  checkStatus(){
    if( this.autoCamActive || this.pxlDevice.mobile || this.active ){
      this.toggleAutoCam(true);
    }
  }

  preAutoCamToggle(){
    //if(this.enabled === false){ // Check active state of Auto Cam
      if( !this.autoCamActive ){
        if( this.pxlCamera.colliderCurObjHit === "AudioTrigger_2" ){
          this.pxlCamera.proximityScaleTrigger=true;
          this.exposureShiftActive=true;
        }
      }
      /*if( this.pxlEnv.pxlQuality.detailLimitOverride ){
        this.enabled=!this.enabled;
        this.active=this.enabled;
        this.autoCamActive=this.enabled;
      }*/
      this.toggleAutoCam();
    //}
  }
  
  setAutoCamMode( curMode=0 ){
    this.autoCamMode=curMode;
    if( curMode===1 ){
      this.resetAutoCam=true;
    }
  }

  // For auto cam swapping
  setPosQuat(pos, quat){ // Vector3, Vector4
    this.camera.quaternion.copy( quat );
    this.camera.position.copy( pos );
    this.pxlCamera.updateCameraMatrices();
    this.pxlCamera.camUpdated=true; // Forces next frame update
  }
    
  /**
   * @memberof pxlAutoCam
   * @function toggleAutoCam
   * @description Toggle the active state of the auto camera system
   * @param {boolean|null} [setValue=null] - If `null`, toggle the current state. If `true` or `false`, set the state directly.
   * @param {number} [dir=1] - Direction to step the auto camera path. `1` for next, `-1` for previous.
   */
  toggleAutoCam( setValue=null, dir=1 ){
    this.pxlEnv.fogMult.x = 1;
    if( this.autoCamPaths[ this.pxlEnv.currentRoom ] ){
      this.curRoom=this.pxlEnv.currentRoom;
      let camPathCount=this.autoCamPaths[ this.pxlEnv.currentRoom ].length;
      if( isNaN(this.autoCamId) ){
        this.autoCamId=camPathCount-1;
      }
      let origActive=this.autoCamActive;

      this.autoCamActive= setValue===null &amp;&amp; camPathCount>0 ? !this.autoCamActive : setValue;
      this.autoCamActive = this.mobile || this.autoCamActive;
      if( !origActive &amp;&amp; this.autoCamActive ){
        this.netDistance= new Vector2().copy( this.pxlDevice.touchMouseData.netDistance );
      }
      this.pxlDevice.touchMouseData.netDistance.multiplyScalar(0);
      
      if( this.autoCamActive ){
        this.pxlCamera.resetGravity(); // Set settings for when Auto-Camera cancels
        
        this.autoCamId = (this.autoCamId+dir) % camPathCount; // Step the auto cam path
        this.autoCamId = this.autoCamId &lt; 0 ? camPathCount-1 : this.autoCamId;
            
        let curAutoCamGroup = this.autoCamPaths[ this.pxlEnv.currentRoom ][this.autoCamId];
        // Path Duration, Point &amp; Look At curve point arrays
        this.totalLoopDuration = curAutoCamGroup.position.userData.duration;
        
        try{
          this.autoCamPositions = curAutoCamGroup.position.geometry.attributes.position;
          this.autoCamLookAt = curAutoCamGroup.lookAt.geometry.attributes.position;
          if( curAutoCamGroup.up ){
            this.autoCamUp=curAutoCamGroup.up.geometry.attributes.position;
          }else{
            this.autoCamUp=null;
            this.camera.up.set( 0,1,0 );
          }
          // Curve count
          this.numControlPoints = this.autoCamPositions.array.length/3;
          
          // Initial time, offset in negative by a random length of the duration
          this.autoCamStartTime = this.pxlTimer.curMS - (this.totalLoopDuration*Math.random());
        }catch(err){}
        
      }else{
        this.setPosQuat(this.pxlCamera.cameraPrevPos.clone(), this.pxlCamera.prevQuaternion.clone());
                
        this.pxlDevice.touchMouseData.netDistance.copy( this.netDistance );
      }
    }
  }
  prevNextAutoCam(dir=1, manual=false){
    // If auto cam active, Left &amp; Right changes current auto cam path
    if( this.autoCamActive ){
      if( this.enabled &amp;&amp; this.active &amp;&amp; !manual ){
        this.nextCamChange = this.pxlTimer.curMS;
      }else{
        this.toggleAutoCam( true, dir );
      }
    }
  }
  setAutoCamPath( path=0 ){
    if( this.autoCamActive ){
      this.autoCamId=path;
      this.toggleAutoCam( true, 0 );
    }
  }
  getAutoCamData(){
    let roomList=Object.keys( this.autoCamPaths );
    let pathCounts={};
    roomList.forEach( (r)=>{
      pathCounts[r]=this.autoCamPaths[r].length;
    });
    return {roomList, pathCounts};
  }

  getAutoCamValueFromCurve(array, curIndex, t_lerp, print=false) {
    // Starting Point
    let x = array[curIndex*3];
    let y = array[curIndex*3 + 1];
    let z = array[curIndex*3 + 2];
    
    // Ending point
    let nextIndex = (curIndex + 1) % (this.numControlPoints);
    let x2 = array[nextIndex*3];
    let y2 = array[nextIndex*3 + 1];
    let z2 = array[nextIndex*3 + 2];
    
    // Lerp
    let pos= new Vector3(x,y,z);//.multiplyScalar(-1);
    let nextPos= new Vector3(x2,y2,z2);//.multiplyScalar(-1);

    pos.lerp(nextPos,t_lerp);
    

    return pos;
    
  } 
  
  updateAutoCamera(){
    
    // TODO : Elevate to active check for running updateAutoCam
    if( !this.autoCamPositions || !this.autoCamPositions.array ){
      return;
    }
    
    // Percent travel along path
    let ms = (this.pxlTimer.curMS - this.autoCamStartTime) % this.totalLoopDuration;

    // Points to blend
    let t = ms/this.totalLoopDuration;
    t *= this.numControlPoints-1;
    let curIndex = Math.floor(t);
    let t_lerp = t - curIndex;
    
    // Current Position math-   
    let cameraPos = this.getAutoCamValueFromCurve(this.autoCamPositions.array, curIndex, t_lerp, false);
    this.camera.position.copy(cameraPos);

    
    // -- -- -- -- -- -- //
    // Camera Look At Calculations
    // Current Look At math-   
    let camLookAt = this.getAutoCamValueFromCurve(this.autoCamLookAt.array, curIndex, t_lerp);
    //camLookAt=cameraPos.clone().add( camLookAt.clone().sub( cameraPos ) );
    this.camera.lookAt(camLookAt);
    
    if( this.autoCamUp ){
      let camUp = this.getAutoCamValueFromCurve(this.autoCamUp.array, curIndex, t_lerp);
      camUp=camUp.sub(cameraPos).normalize();
      this.camera.up.copy( camUp  );
    }
    
    /*let camPoseQuat=new Quaternion();
    let euler=new Euler();
    euler.set(0,0,180,'YXZ'); // Device returns YXZ for deviceOrientation
    camPoseQuat.setFromEuler(euler);
    camPoseQuat.normalize();
    camPoseQuat.multiply( this.camera.quaternion );
    this.camera.setRotationFromQuaternion(camPoseQuat);*/
  }
  
  applyTouchRotate(){
    // this.pxlDevice.touchMouseData.startPos;
    // this.pxlDevice.touchMouseData.endPos;
    // this.pxlDevice.touchMouseData.netDistance;
    let blendOut=1;
    if( this.touchBlender ){
      // Camera rotation easing logic-
      blendOut=Math.min(1, Math.max(0, this.pxlTimer.curMS - this.pxlDevice.touchMouseData.releaseTime ));
      blendOut*=blendOut;
      this.pxlDevice.touchMouseData.netDistance.multiplyScalar(1-blendOut);
      this.touchBlender=blendOut&lt;1;
    }else{
      this.pxlDevice.touchMouseData.netDistance.multiplyScalar(.5);
    }
   let euler=new Euler();
    euler.set(
      (this.pxlDevice.touchMouseData.netDistance.y/this.pxlDevice.sH*2),
      (this.pxlDevice.touchMouseData.netDistance.x/this.pxlDevice.sW*2),
      0,
      'YXZ'); // Device returns YXZ for deviceOrientation
    // Limit Up/Down looking
    let camPoseQuat=new Quaternion().clone( this.camera.quaternion );
    camPoseQuat.setFromEuler(euler);
    camPoseQuat=this.camera.quaternion.clone().multiply(camPoseQuat);
    //camPoseQuat.multiply(poseQuat.setFromAxisAngle(viewNormal,-this.cameraPose.orientation));
    camPoseQuat.normalize();
    
    // let smoothedQuat=new Quaternion();
        
    if( this.touchBlender ){
      camPoseQuat.slerp(this.camera.quaternion.clone(),blendOut).normalize();
    }
    let lookAt= new Vector3(0,0,-10).applyQuaternion( camPoseQuat ).add( this.camera.position );
        
    this.camera.setRotationFromQuaternion(camPoseQuat);//smoothedQuat);
    this.camera.lookAt(lookAt);
    this.camera.up.set( 0,1,0 );
  }
}</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.4</a> on Sun Sep 14 2025 23:24:32 GMT-0400 (Eastern Daylight Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>



    <script src="https://unpkg.com/mermaid/dist/mermaid.js"></script>
    
    <script src="docs-init.js"></script>
    
</body>
</html>
